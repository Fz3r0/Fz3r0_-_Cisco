Router 1 - SDWAN Edge
# üß†üèóÔ∏èüåê Cisco Nexus: `NX-OS - Tier 3 Fabric PT1 : OSPF Overlay + Essential Configs`

![My Video](https://user-images.githubusercontent.com/94720207/165892585-b830998d-d7c5-43b4-a3ad-f71a07b9077e.gif)

### üê¶ Twitter  : [@fz3r0_OPs](https://twitter.com/Fz3r0_OPs)
### üê± Github  : [Fz3r0](https://github.com/fz3r0) 

---
 
#### Keywords: `Cisco` `CCNA` `CCNP` `Datacenter` `NX-OS` `Cisco Nexus` `Leaf & Spine` `DC Switching` `Modular Chassis` `Fixed Form Factor` `vPC` `ECMP` `FEX` `Fabric Extender` `Nexus 2000` `Nexus 5000` `Nexus 7000` `Nexus 9000`  `Port-Channel` `LAG` `VLAN` `VRF` `Overlay` `Underlay` `EVPN` `VXLAN`  `Spine Switch` `Leaf Switch` `Control Plane` `Forwarding Plane` `Supervisor Card` `Line Card`  `Redundant Power Supply` `Hot-swappable` `In-Service Software Upgrade (ISSU)` `High Availability`  `Twinax Cable` `SFP+` `QSFP28` `QSFP-DD` `10G` `25G` `40G` `100G` `400G`

---

<br>

# üìÑ `Index`



[**üóÉÔ∏è Resources**](https://github.com/Fz3r0/Fz3r0_-_Cisco/blob/main/Cisco_Nexus/Cisco_Nexus_Labs/01-F0-Nexus_DC-CollapsedCore-HA.md#%EF%B8%8F-resources)

# üèóÔ∏è Cisco Nexus :: `NX-OS - Tier 3 Fabric PT1 : OSPF Overlay + Essential Configs`



## üéØ Objectives, Features & Protocols Covered

## üé• Lab Proof of Concept (PoC) - Video

- [**üëâ Click here to go to the PoC video üëà**](https://youtu.be/RL9hBT0H7UE)

## üó∫Ô∏è Network Topology

![image](https://github.com/user-attachments/assets/48bb7754-e29d-4e00-88e3-5e126d4a89ef)








## üìã Network Device Inventory & IP Addressing



## üìù Lab Notes

Credentials:

- Admin: `admin`
- Pass: `Adm1n.C1sc0`

Notes:

- During Nexus Switches start-up, select `skip` during "Abort Power On Auto Provisioning (yes - continue with normal setup, skip - bypass password and basic configuration, no - continue with Power On Auto Provisioning) (yes/skip/no)[no]: `skip`"
- The NX9-1 and NX9-2 must be powered on and configured before the edge routers, otherwise OSPF process 1 could bug/error.
- Check that all virtual NX devices are powered on and have no CLI issues; sometimes they can hang or freeze when too many sessions are open or multiple processes are running. <br><br>
- Overlapping subnet warning (e.g. between Lo0 and VLAN10 `overlapping network for ipv4 address: 10.10.1.211/24 on vlan10, 10.10.1.11/32 already configured on lo0`) **is expected**.  It‚Äôs safe to ignore Loopback uses /32 for OSPF RID and can coexist with SVI in the same subnet.

# **‚öôÔ∏è Devices Configurations**

- Copy & Paste the configuration in each device CLI

## üëëü•á `NX9-BGW-1A` - (Border Gateway - VPC-A)

````py
configure terminal
banner motd $


#######################################################################################
#                                                                                     #
#                        - Fz3r0 :: Cisco Nexus Data Center -                         #
#                                                                                     #
#   * Github      : Fz3r0                                                             #
#   * Twitter     : @fz3r0_OPs                                                        #
#   * Youtube     : @fz3r0_OPs                                                        #
#                                                                                     #
# -._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-._.-=-._.-=-._.-=-.#
#                                                                                     #
#    NEXUS        : NX9-BGW-1A                                                        #
#    ROLE         : Border Gateway (A)                                                #
#                                                                                     #
#    MGMT         : 10.10.66.11/24                                                    #
#    LOGIN        : admin / admin.cisco                                               #
#                                                                                     #
#    VRFs:                                                                            #
#    - default                                                                        #
#    - management                                                                     #
#    - *vpc-keepalive                                                                 #
#                                                                                     #
#    VPCs:                                                                            #
#    - vPC Domain 666 (BGW-1A <==> BGW-1B)                                             #
#      * PeerLink  @ Po100                                                            #
#      * KeepAlive @ Eth5                                                             #
#                                                                                     #
#    PORT CHANNELS:                                                                   #
#    - None                                                                           #
#                                                                                     #
#     OSPF UNDERLAY                                                                   #
#    - OSPF ID    : UNDERLAY-F0                                                       #
#    - OSPF AREA  : 0.0.0.0 (Backbone)                                                #
#    - Lo0        : 10.10.1.11/32                                                     #
#    - RID        : 10.10.1.11                                                        #
#    - Peer-SVI   : 10.10.1.211/24 (VLAN 10 - OSPF-PEER)                              #
#                                                                                     #
#######################################################################################


$

!# NAMINGS, USERS, LICENSES, DISCOVERY
hostname NX9-BGW-1A
no password strength-check
username admin password admin.cisco role network-admin
cdp enable

!# MANAGEMENT INTERFACE & VRF (IP/GATEWAY)

!# Add DNS and Default Gateway to MGMT VLAN/VRF
vrf context management
   ip name-server 8.8.8.8 8.8.4.4
   ip route 0.0.0.0/0 10.10.66.254
!# Configure mgmt0 interface
interface mgmt0
   description ** MGMT INTERFACE **
   no shutdown
   vrf member management
   ip address 10.10.66.11/24
exit

!#######################################################################################
!#  FEATURES                                                                           #
!#######################################################################################

!# Port Channel & vPC:
feature vpc
feature lacp

!# Interface VLAN (for SVI)
feature interface-vlan

!# OSPF (Underlay)
feature ospf

!# Remote Connection
feature telnet
feature ssh

!# Discovery
feature lldp

!#######################################################################################
!#  vPC CONFIGURATION                                                                  #
!#######################################################################################

!# vPC Configuration: << vPC Domain 666 >> 

!# 1 - Create VRF "vpc-keepalive"
vrf context vpc-keepalive
   description ** Keepalive path for vPC control-plane **
exit

!# 2 - Create new "vpc-keepalive" physical interface for P2P link
interface Ethernet 1/5
   description ** vPC KeepAlive Link (A) **
   no shutdown
      no switchport
         vrf member vpc-keepalive
         ip address 10.10.255.1/30
exit

!# 3 - Create vPC Domain "666" and configure KeepAlive-Link (Primary = 100 (lower))
vpc domain 666
   peer-keepalive destination 10.10.255.2 source 10.10.255.1 vrf vpc-keepalive
      role priority 100              
      auto-recovery
      auto-recovery reload-delay 60
      delay restore 1             
      system-priority 1000             
exit

!# 4 - Configure vPC Peer Link - Port Channel 100 (Eth6 & Eth7)
interface ethernet 1/6
   description ** (Po100) vPC Peer-Link - Interface 1of2 **
   no shutdown
      channel-group 100 mode active
exit
interface ethernet 1/7
   description ** (Po100) vPC Peer-Link - Interface 2of2 **
   no shutdown
      channel-group 100 mode active
exit
interface port-channel 100
   description ** (Po100) vPC Peer-Link Port-Channel **
   no shutdown
      switchport
      switchport mode trunk
      switchport trunk allowed vlan 10
         vpc peer-link     
exit

!#######################################################################################
!#  OSPF (UNDERLAY)                                                                    #
!#######################################################################################

!# 1 - Activate OSPF Process
router ospf UNDERLAY-F0
   router-id 10.10.1.11
      log-adjacency-changes
exit

!# 2 - Configure Loopback 0 Interface
interface loopback 0
   description ** Loopback 0 - OSPF UNDERLAY **
      ip address 10.10.1.11/32
         ip router ospf UNDERLAY-F0 area 0.0.0.0
exit

!# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-#

!# 4 - OSPF Peer Interfaces @ OSPF Neighbors: 

#! SVI for VLAN 10 - OSPF Reachability
vlan 10
   name VLAN10-OSPF-PEER-GW
exit
interface vlan 10
   description ** SVI-V10-OSPF-UNDERLAY-GW **
   no shutdown
      ip address 10.10.1.211/24 
exit
#! Static default route (Default Gateway) for OSPF underlay in default VRF
ip route 0.0.0.0/0 10.10.1.254

!# INTERFACE :: ETH 1/1 @ SPINE-1 
interface ethernet1/1
   description ** OSPF Peer @ Spine-1 **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.100/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!# INTERFACE :: ETH 1/2 @ SPINE-2
interface ethernet1/2
   description ** OSPF Peer @ Spine-2 **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.102/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!#######################################################################################
!#  WAN INTERFACE + L3 SUB-INTERFACE @ OSPF 10                                         #
!#######################################################################################

!# OSPF 10
router ospf 10
   router-id 10.10.1.11
exit

!# INTERFACE :: ETH 1/3 @ WAN ROUTER (OSPF 10)
interface Ethernet1/3
   description *** Link ‚Üí WAN ROUTER Eth0/1 ***
   no shutdown
   speed 1000
   duplex full
      no switchport
exit
!# SUB-INTERFACE
interface Ethernet1/3.10
   description *** Link ‚Üí WAN ROUTER Eth0/1 ***
   no shutdown
      encapsulation dot1q 10
      ip address 10.10.2.102/30
         ip router ospf 10 area 0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!#######################################################################################
!#  SAVE CHECKPOINT & CONFIGURATION                                                    #
!#######################################################################################

end
checkpoint fz3r0-2025-3tier-OSPF_base-NX9-BGW-1A
copy running-config startup-config

!
!


````

## üëëü•à `NX9-BGW-1B` - (Border Gateway - VPC-B)

````py
configure terminal
banner motd $


#######################################################################################
#                                                                                     #
#                        - Fz3r0 :: Cisco Nexus Data Center -                         #
#                                                                                     #
#   * Github      : Fz3r0                                                             #
#   * Twitter     : @fz3r0_OPs                                                        #
#   * Youtube     : @fz3r0_OPs                                                        #
#                                                                                     #
# -._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-._.-=-._.-=-._.-=-.#
#                                                                                     #
#    NEXUS        : NX9-BGW-1B                                                        #
#    ROLE         : Border Gateway (B)                                                #
#                                                                                     #
#    MGMT         : 10.10.66.12/24                                                    #
#    LOGIN        : admin / admin.cisco                                               #
#                                                                                     #
#    VRFs:                                                                            #
#    - default                                                                        #
#    - management                                                                     #
#    - *vpc-keepalive                                                                 #
#                                                                                     #
#    VPCs:                                                                            #
#    - vPC Domain 666 (BGW-1B <==> BGW1A)                                             #
#      * PeerLink  @ Po100                                                            #
#      * KeepAlive @ Eth5                                                             #
#                                                                                     #
#    PORT CHANNELS:                                                                   #
#    - None                                                                           #
#                                                                                     #
#     OSPF UNDERLAY                                                                   #
#    - OSPF ID    : UNDERLAY-F0                                                       #
#    - OSPF AREA  : 0.0.0.0 (Backbone)                                                #
#    - Lo0        : 10.10.1.12/32                                                     #
#    - RID        : 10.10.1.12                                                        #
#    - Peer-SVI   : 10.10.1.212/24 (VLAN 10 - OSPF-PEER)                              #
#                                                                                     #
#######################################################################################


$

!# NAMINGS, USERS, LICENSES, DISCOVERY
hostname NX9-BGW-1B
no password strength-check
username admin password admin.cisco role network-admin
cdp enable

!# MANAGEMENT INTERFACE & VRF (IP/GATEWAY)

!# Add DNS and Default Gateway to MGMT VLAN/VRF
vrf context management
   ip name-server 8.8.8.8 8.8.4.4
   ip route 0.0.0.0/0 10.10.66.254
!# Configure mgmt0 interface
interface mgmt0
   description ** MGMT INTERFACE **
   no shutdown
   vrf member management
   ip address 10.10.66.12/24
exit

!#######################################################################################
!#  FEATURES                                                                           #
!#######################################################################################

!# Port Channel & vPC:
feature vpc
feature lacp

!# Interface VLAN (for SVI)
feature interface-vlan

!# OSPF (Underlay)
feature ospf

!# Remote Connection
feature telnet
feature ssh

!# Discovery
feature lldp

!#######################################################################################
!#  vPC CONFIGURATION                                                                  #
!#######################################################################################

!# vPC Configuration: << vPC Domain 666 >> 

!# 1 - Create VRF "vpc-keepalive"
vrf context vpc-keepalive
   description ** Keepalive path for vPC control-plane **
exit

!# 2 - Create new "vpc-keepalive" physical interface for P2P link
interface Ethernet 1/5
   description ** vPC KeepAlive Link (B) **
   no shutdown
      no switchport
         vrf member vpc-keepalive
         ip address 10.10.255.2/30
exit

!# 3 - Create vPC Domain "666" and configure KeepAlive-Link (Secondary = 200 (higher))
vpc domain 666
   peer-keepalive destination 10.10.255.1 source 10.10.255.2 vrf vpc-keepalive
      role priority 200              
      auto-recovery
      auto-recovery reload-delay 60
      delay restore 1             
      system-priority 1000             
exit

!# 4 - Configure vPC Peer Link - Port Channel 100 (Eth6 & Eth7)
interface ethernet 1/6
   description ** (Po100) vPC Peer-Link - Interface 1of2 **
   no shutdown
      channel-group 100 mode active
exit
interface ethernet 1/7
   description ** (Po100) vPC Peer-Link - Interface 2of2 **
   no shutdown
      channel-group 100 mode active
exit
interface port-channel 100
   description ** (Po100) vPC Peer-Link Port-Channel **
   no shutdown
      switchport
      switchport mode trunk
      switchport trunk allowed vlan 10
         vpc peer-link     
exit

!#######################################################################################
!#  OSPF (UNDERLAY)                                                                    #
!#######################################################################################

!# 1 - Activate OSPF Process
router ospf UNDERLAY-F0
   router-id 10.10.1.12
      log-adjacency-changes
exit

!# 2 - Configure Loopback 0 Interface
interface loopback 0
   description ** Loopback 0 - OSPF UNDERLAY **
      ip address 10.10.1.12/32
         ip router ospf UNDERLAY-F0 area 0.0.0.0
exit

!# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-#

!# 4 - OSPF Peer Interfaces @ OSPF Neighbors: 

#! SVI for VLAN 10 - OSPF Reachability
vlan 10
   name VLAN10-OSPF-PEER-GW
exit
interface vlan 10
   description ** SVI-V10-OSPF-UNDERLAY-GW **
   no shutdown
      ip address 10.10.1.212/24 
exit
#! Static default route (Default Gateway) for OSPF underlay in default VRF
ip route 0.0.0.0/0 10.10.1.254

!# INTERFACE :: ETH 1/1 @ SPINE-2
interface ethernet1/1
   description ** OSPF Peer @ SPINE-2 **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.106/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!# INTERFACE :: ETH 1/2 @ SPINE-1
interface ethernet1/2
   description ** OSPF Peer @ SPINE-1 **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.104/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!#######################################################################################
!#  WAN INTERFACE + L3 SUB-INTERFACE @ OSPF 10                                         #
!#######################################################################################

!# OSPF 10
router ospf 10
   router-id 10.10.1.12
exit

!# INTERFACE :: ETH 1/3 @ WAN ROUTER (OSPF 10)
interface Ethernet1/3
   description *** Link ‚Üí WAN ROUTER Eth0/1 ***
   no shutdown
   speed 1000
   duplex full
      no switchport
exit
!# SUB-INTERFACE
interface Ethernet1/3.10
   description *** Link ‚Üí WAN ROUTER Eth0/1 ***
   no shutdown
      encapsulation dot1q 10
      ip address 10.10.2.106/30
         ip router ospf 10 area 0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!#######################################################################################
!#  SAVE CHECKPOINT & CONFIGURATION                                                    #
!#######################################################################################

end
checkpoint fz3r0-2025-3tier-OSPF_base-NX9-BGW-1B
copy running-config startup-config

!
!


````

## ü©ªü•á `NX9-SPINE-1` - (SPINE 1)

````py
configure terminal
banner motd $


#######################################################################################
#                                                                                     #
#                        - Fz3r0 :: Cisco Nexus Data Center -                         #
#                                                                                     #
#   * Github      : Fz3r0                                                             #
#   * Twitter     : @fz3r0_OPs                                                        #
#   * Youtube     : @fz3r0_OPs                                                        #
#                                                                                     #
# -._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-._.-=-._.-=-._.-=-.#
#                                                                                     #
#    NEXUS        : NX9-SPINE-1                                                       #
#    ROLE         : SPINE 1                                                           #
#                                                                                     #
#    MGMT         : 10.10.66.13/24                                                    #
#    LOGIN        : admin / admin.cisco                                               #
#                                                                                     #
#    VRFs:                                                                            #
#    - default                                                                        #
#    - management                                                                     #
#                                                                                     #
#    VPCs:                                                                            #
#    - None                                                                           #
#                                                                                     #
#    PORT CHANNELS:                                                                   #
#    - None                                                                           #
#                                                                                     #
#     OSPF UNDERLAY                                                                   #
#    - OSPF ID    : UNDERLAY-F0                                                       #
#    - OSPF AREA  : 0.0.0.0 (Backbone)                                                #
#    - Lo0        : 10.10.1.13/32                                                     #
#    - RID        : 10.10.1.13                                                        #
#    - Peer-SVI   : 10.10.1.213/24 (VLAN 10 - OSPF-PEER)                              #
#                                                                                     #
#######################################################################################


$

!# NAMINGS, USERS, LICENSES, DISCOVERY
hostname NX9-SPINE-1
no password strength-check
username admin password admin.cisco role network-admin
cdp enable

!# MANAGEMENT INTERFACE & VRF (IP/GATEWAY)

!# Add DNS and Default Gateway to MGMT VLAN/VRF
vrf context management
   ip name-server 8.8.8.8 8.8.4.4
   ip route 0.0.0.0/0 10.10.66.254
!# Configure mgmt0 interface
interface mgmt0
   description ** MGMT INTERFACE **
   no shutdown
   vrf member management
   ip address 10.10.66.13/24
exit

!#######################################################################################
!#  FEATURES                                                                           #
!#######################################################################################

!# Interface VLAN (for SVI)
feature interface-vlan

!# OSPF (Underlay)
feature ospf

!# Remote Connection
feature telnet
feature ssh

!# Discovery
feature lldp

!#######################################################################################
!#  OSPF (UNDERLAY)                                                                    #
!#######################################################################################

!# 1 - Activate OSPF Process
router ospf UNDERLAY-F0
   router-id 10.10.1.13
      log-adjacency-changes
exit

!# 2 - Configure Loopback 0 Interface
interface loopback 0
   description ** Loopback 0 - OSPF UNDERLAY **
      ip address 10.10.1.13/32
         ip router ospf UNDERLAY-F0 area 0.0.0.0
exit

!# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-#

!# 4 - OSPF Peer Interfaces @ OSPF Neighbors: 

#! SVI for VLAN 10 - OSPF Reachability
vlan 10
   name VLAN10-OSPF-PEER-GW
exit
interface vlan 10
   description ** SVI-V10-OSPF-UNDERLAY-GW **
   no shutdown
      ip address 10.10.1.213/24 
exit
#! Static default route (Default Gateway) for OSPF underlay in default VRF
ip route 0.0.0.0/0 10.10.1.254

!# INTERFACE :: ETH 1/1 @ BGW-1A
interface ethernet1/1
   description ** OSPF Peer @ BGW-1A **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.101/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!# INTERFACE :: ETH 1/2 @ BGW-1B
interface ethernet1/2
   description ** OSPF Peer @ BGW-1B **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.105/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!# INTERFACE :: ETH 1/3 @ LEAF-1A
interface ethernet1/3
   description ** OSPF Peer @ LEAF-1A **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.108/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!# INTERFACE :: ETH 1/4 @ LEAF-1B
interface ethernet1/4
   description ** OSPF Peer @ LEAF-1B **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.110/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!# INTERFACE :: ETH 1/5 @ LEAF-2A
interface ethernet1/5
   description ** OSPF Peer @ LEAF-2A **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.112/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!# INTERFACE :: ETH 1/6 @ LEAF-2B
interface ethernet1/6
   description ** OSPF Peer @ LEAF-2B **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.114/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!#######################################################################################
!#  SAVE CHECKPOINT & CONFIGURATION                                                    #
!#######################################################################################

end
checkpoint fz3r0-2025-3tier-OSPF_base-NX9-SPINE-1
copy running-config startup-config

!
!


````

## ü©ªü•à `NX9-SPINE-2` - (SPINE 2)

````py
configure terminal
banner motd $


#######################################################################################
#                                                                                     #
#                        - Fz3r0 :: Cisco Nexus Data Center -                         #
#                                                                                     #
#   * Github      : Fz3r0                                                             #
#   * Twitter     : @fz3r0_OPs                                                        #
#   * Youtube     : @fz3r0_OPs                                                        #
#                                                                                     #
# -._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-._.-=-._.-=-._.-=-.#
#                                                                                     #
#    NEXUS        : NX9-SPINE-2                                                       #
#    ROLE         : SPINE 2                                                           #
#                                                                                     #
#    MGMT         : 10.10.66.14/24                                                    #
#    LOGIN        : admin / admin.cisco                                               #
#                                                                                     #
#    VRFs:                                                                            #
#    - default                                                                        #
#    - management                                                                     #
#                                                                                     #
#    VPCs:                                                                            #
#    - None                                                                           #
#                                                                                     #
#    PORT CHANNELS:                                                                   #
#    - None                                                                           #
#                                                                                     #
#     OSPF UNDERLAY                                                                   #
#    - OSPF ID    : UNDERLAY-F0                                                       #
#    - OSPF AREA  : 0.0.0.0 (Backbone)                                                #
#    - Lo0        : 10.10.1.14/32                                                     #
#    - RID        : 10.10.1.14                                                        #
#    - Peer-SVI   : 10.10.1.214/24 (VLAN 10 - OSPF-PEER)                              #
#                                                                                     #
#######################################################################################


$

!# NAMINGS, USERS, LICENSES, DISCOVERY
hostname NX9-SPINE-2
no password strength-check
username admin password admin.cisco role network-admin
cdp enable

!# MANAGEMENT INTERFACE & VRF (IP/GATEWAY)

!# Add DNS and Default Gateway to MGMT VLAN/VRF
vrf context management
   ip name-server 8.8.8.8 8.8.4.4
   ip route 0.0.0.0/0 10.10.66.254
!# Configure mgmt0 interface
interface mgmt0
   description ** MGMT INTERFACE **
   no shutdown
   vrf member management
   ip address 10.10.66.14/24
exit

!#######################################################################################
!#  FEATURES                                                                           #
!#######################################################################################

!# Interface VLAN (for SVI)
feature interface-vlan

!# OSPF (Underlay)
feature ospf

!# Remote Connection
feature telnet
feature ssh

!# Discovery
feature lldp

!#######################################################################################
!#  OSPF (UNDERLAY)                                                                    #
!#######################################################################################

!# 1 - Activate OSPF Process
router ospf UNDERLAY-F0
   router-id 10.10.1.14
      log-adjacency-changes
exit

!# 2 - Configure Loopback 0 Interface
interface loopback 0
   description ** Loopback 0 - OSPF UNDERLAY **
      ip address 10.10.1.14/32
         ip router ospf UNDERLAY-F0 area 0.0.0.0
exit

!# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-#

!# 4 - OSPF Peer Interfaces @ OSPF Neighbors: 

#! SVI for VLAN 10 - OSPF Reachability
vlan 10
   name VLAN10-OSPF-PEER-GW
exit
interface vlan 10
   description ** SVI-V10-OSPF-UNDERLAY-GW **
   no shutdown
      ip address 10.10.1.214/24 
exit
#! Static default route (Default Gateway) for OSPF underlay in default VRF
ip route 0.0.0.0/0 10.10.1.254

!# INTERFACE :: ETH 1/1 @ BGW-1B
interface ethernet1/1
   description ** OSPF Peer @ BGW-1B **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.107/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!# INTERFACE :: ETH 1/2 @ BGW-1A
interface ethernet1/2
   description ** OSPF Peer @ BGW-1A **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.103/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!# INTERFACE :: ETH 1/3 @ LEAF-1A
interface ethernet1/3
   description ** OSPF Peer @ LEAF-1A **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.116/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!# INTERFACE :: ETH 1/4 @ LEAF-1B
interface ethernet1/4
   description ** OSPF Peer @ LEAF-1B **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.118/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!# INTERFACE :: ETH 1/5 @ LEAF-2A
interface ethernet1/5
   description ** OSPF Peer @ LEAF-2A **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.120/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!# INTERFACE :: ETH 1/6 @ LEAF-2B
interface ethernet1/6
   description ** OSPF Peer @ LEAF-2B **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.122/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!#######################################################################################
!#  SAVE CHECKPOINT & CONFIGURATION                                                    #
!#######################################################################################

end
checkpoint fz3r0-2025-3tier-OSPF_base-NX9-SPINE-2
copy running-config startup-config

!
!


````






## üåøü•á `NX9-LEAF-1A` - (LEAF 1 - VPC-A)

````py
configure terminal
banner motd $


#######################################################################################
#                                                                                     #
#                        - Fz3r0 :: Cisco Nexus Data Center -                         #
#                                                                                     #
#   * Github      : Fz3r0                                                             #
#   * Twitter     : @fz3r0_OPs                                                        #
#   * Youtube     : @fz3r0_OPs                                                        #
#                                                                                     #
# -._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-._.-=-._.-=-._.-=-.#
#                                                                                     #
#    NEXUS        : NX9-LEAF-1A                                                       #
#    ROLE         : LEAF                                                              #
#                                                                                     #
#    MGMT         : 10.10.66.15/24                                                    #
#    LOGIN        : admin / admin.cisco                                               #
#                                                                                     #
#    VRFs:                                                                            #
#    - default                                                                        #
#    - management                                                                     #
#    - *vpc-keepalive                                                                 #
#                                                                                     #
#    VPCs:                                                                            #
#    - vPC Domain 666 (LEAF-1A <==> LEAF-1B)                                          #
#      * PeerLink  @ Po100                                                            #
#      * KeepAlive @ Eth5                                                             #
#                                                                                     #
#    PORT CHANNELS:                                                                   #
#    - None                                                                           #
#                                                                                     #
#     OSPF UNDERLAY                                                                   #
#    - OSPF ID    : UNDERLAY-F0                                                       #
#    - OSPF AREA  : 0.0.0.0 (Backbone)                                                #
#    - Lo0        : 10.10.1.15/32                                                     #
#    - RID        : 10.10.1.15                                                        #
#    - Peer-SVI   : 10.10.1.215/24 (VLAN 10 - OSPF-PEER)                              #
#                                                                                     #
#######################################################################################


$

!# NAMINGS, USERS, LICENSES, DISCOVERY
hostname NX9-LEAF-1A
no password strength-check
username admin password admin.cisco role network-admin
cdp enable

!# MANAGEMENT INTERFACE & VRF (IP/GATEWAY)

!# Add DNS and Default Gateway to MGMT VLAN/VRF
vrf context management
   ip name-server 8.8.8.8 8.8.4.4
   ip route 0.0.0.0/0 10.10.66.254
!# Configure mgmt0 interface
interface mgmt0
   description ** MGMT INTERFACE **
   no shutdown
   vrf member management
   ip address 10.10.66.15/24
exit

!#######################################################################################
!#  FEATURES                                                                           #
!#######################################################################################

!# Port Channel & vPC: (tba)
feature vpc
feature lacp

!# Interface VLAN (for SVI)
feature interface-vlan

!# OSPF (Underlay)
feature ospf

!# Remote Connection
feature telnet
feature ssh

!# Discovery
feature lldp

!#######################################################################################
!#  vPC CONFIGURATION                                                                  #
!#######################################################################################

!# vPC Configuration: << vPC Domain 666 >> 

!# 1 - Create VRF "vpc-keepalive"
vrf context vpc-keepalive
   description ** Keepalive path for vPC control-plane **
exit

!# 2 - Create new "vpc-keepalive" physical interface for P2P link
interface Ethernet 1/5
   description ** vPC KeepAlive Link (A) **
   no shutdown
      no switchport
         vrf member vpc-keepalive
         ip address 10.10.255.1/30
exit

!# 3 - Create vPC Domain "666" and configure KeepAlive-Link (Primary = 100 (lower))
vpc domain 666
   peer-keepalive destination 10.10.255.2 source 10.10.255.1 vrf vpc-keepalive
      role priority 100              
      auto-recovery
      auto-recovery reload-delay 60
      delay restore 1             
      system-priority 1000             
exit

!# 4 - Configure vPC Peer Link - Port Channel 100 (Eth6 & Eth7)
interface ethernet 1/6
   description ** (Po100) vPC Peer-Link - Interface 1of2 **
   no shutdown
      channel-group 100 mode active
exit
interface ethernet 1/7
   description ** (Po100) vPC Peer-Link - Interface 2of2 **
   no shutdown
      channel-group 100 mode active
exit
interface port-channel 100
   description ** (Po100) vPC Peer-Link Port-Channel **
   no shutdown
      switchport
      switchport mode trunk
      switchport trunk allowed vlan 10
         vpc peer-link     
exit

!#######################################################################################
!#  OSPF (UNDERLAY)                                                                    #
!#######################################################################################

!# 1 - Activate OSPF Process
router ospf UNDERLAY-F0
   router-id 10.10.1.15
      log-adjacency-changes
exit

!# 2 - Configure Loopback 0 Interface
interface loopback 0
   description ** Loopback 0 - OSPF UNDERLAY **
      ip address 10.10.1.15/32
         ip router ospf UNDERLAY-F0 area 0.0.0.0
exit

!# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-#

!# 4 - OSPF Peer Interfaces @ OSPF Neighbors: 

#! SVI for VLAN 10 - OSPF Reachability
vlan 10
   name VLAN10-OSPF-PEER-GW
exit
interface vlan 10
   description ** SVI-V10-OSPF-UNDERLAY-GW **
   no shutdown
      ip address 10.10.1.215/24 
exit
#! Static default route (Default Gateway) for OSPF underlay in default VRF
ip route 0.0.0.0/0 10.10.1.254

!# INTERFACE :: ETH 1/1 @ SPINE-1
interface ethernet1/1
   description ** OSPF Peer @ SPINE-1 **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.109/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!# INTERFACE :: ETH 1/2 @ SPINE-2
interface ethernet1/2
   description ** OSPF Peer @ SPINE-2 **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.117/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!#######################################################################################
!#  SAVE CHECKPOINT & CONFIGURATION                                                    #
!#######################################################################################

end
checkpoint fz3r0-2025-3tier-OSPF_base-NX9-LEAF-1A
copy running-config startup-config

!
!


````

## üåøü•à `NX9-LEAF-1B` - (LEAF 1 - VPC-B)

````py
configure terminal
banner motd $


#######################################################################################
#                                                                                     #
#                        - Fz3r0 :: Cisco Nexus Data Center -                         #
#                                                                                     #
#   * Github      : Fz3r0                                                             #
#   * Twitter     : @fz3r0_OPs                                                        #
#   * Youtube     : @fz3r0_OPs                                                        #
#                                                                                     #
# -._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-._.-=-._.-=-._.-=-.#
#                                                                                     #
#    NEXUS        : NX9-LEAF-1B                                                       #
#    ROLE         : LEAF                                                              #
#                                                                                     #
#    MGMT         : 10.10.66.16/24                                                    #
#    LOGIN        : admin / admin.cisco                                               #
#                                                                                     #
#    VRFs:                                                                            #
#    - default                                                                        #
#    - management                                                                     #
#    - *vpc-keepalive                                                                 #
#                                                                                     #
#    VPCs:                                                                            #
#    - vPC Domain 666 (LEAF-1B <==> LEAF-1A)                                          #
#      * PeerLink  @ Po100                                                            #
#      * KeepAlive @ Eth5                                                             #
#                                                                                     #
#    PORT CHANNELS:                                                                   #
#    - None                                                                           #
#                                                                                     #
#     OSPF UNDERLAY                                                                   #
#    - OSPF ID    : UNDERLAY-F0                                                       #
#    - OSPF AREA  : 0.0.0.0 (Backbone)                                                #
#    - Lo0        : 10.10.1.16/32                                                     #
#    - RID        : 10.10.1.16                                                        #
#    - Peer-SVI   : 10.10.1.216/24 (VLAN 10 - OSPF-PEER)                              #
#                                                                                     #
#######################################################################################


$

!# NAMINGS, USERS, LICENSES, DISCOVERY
hostname NX9-LEAF-1B
no password strength-check
username admin password admin.cisco role network-admin
cdp enable

!# MANAGEMENT INTERFACE & VRF (IP/GATEWAY)

!# Add DNS and Default Gateway to MGMT VLAN/VRF
vrf context management
   ip name-server 8.8.8.8 8.8.4.4
   ip route 0.0.0.0/0 10.10.66.254
!# Configure mgmt0 interface
interface mgmt0
   description ** MGMT INTERFACE **
   no shutdown
   vrf member management
   ip address 10.10.66.16/24
exit

!#######################################################################################
!#  FEATURES                                                                           #
!#######################################################################################

!# Port Channel & vPC: (tba)
feature vpc
feature lacp

!# Interface VLAN (for SVI)
feature interface-vlan

!# OSPF (Underlay)
feature ospf

!# Remote Connection
feature telnet
feature ssh

!# Discovery
feature lldp

!#######################################################################################
!#  vPC CONFIGURATION                                                                  #
!#######################################################################################

!# vPC Configuration: << vPC Domain 666 >> 

!# 1 - Create VRF "vpc-keepalive"
vrf context vpc-keepalive
   description ** Keepalive path for vPC control-plane **
exit

!# 2 - Create new "vpc-keepalive" physical interface for P2P link
interface Ethernet 1/5
   description ** vPC KeepAlive Link (B) **
   no shutdown
      no switchport
         vrf member vpc-keepalive
         ip address 10.10.255.2/30
exit

!# 3 - Create vPC Domain "666" and configure KeepAlive-Link (Secondary = 200 (higher))
vpc domain 666
   peer-keepalive destination 10.10.255.1 source 10.10.255.2 vrf vpc-keepalive
      role priority 200              
      auto-recovery
      auto-recovery reload-delay 60
      delay restore 1             
      system-priority 1000             
exit

!# 4 - Configure vPC Peer Link - Port Channel 100 (Eth6 & Eth7)
interface ethernet 1/6
   description ** (Po100) vPC Peer-Link - Interface 1of2 **
   no shutdown
      channel-group 100 mode active
exit
interface ethernet 1/7
   description ** (Po100) vPC Peer-Link - Interface 2of2 **
   no shutdown
      channel-group 100 mode active
exit
interface port-channel 100
   description ** (Po100) vPC Peer-Link Port-Channel **
   no shutdown
      switchport
      switchport mode trunk
      switchport trunk allowed vlan 10
         vpc peer-link     
exit

!#######################################################################################
!#  OSPF (UNDERLAY)                                                                    #
!#######################################################################################

!# 1 - Activate OSPF Process
router ospf UNDERLAY-F0
   router-id 10.10.1.16
      log-adjacency-changes
exit

!# 2 - Configure Loopback 0 Interface
interface loopback 0
   description ** Loopback 0 - OSPF UNDERLAY **
      ip address 10.10.1.16/32
         ip router ospf UNDERLAY-F0 area 0.0.0.0
exit

!# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-#

!# 4 - OSPF Peer Interfaces @ OSPF Neighbors: 

#! SVI for VLAN 10 - OSPF Reachability
vlan 10
   name VLAN10-OSPF-PEER-GW
exit
interface vlan 10
   description ** SVI-V10-OSPF-UNDERLAY-GW **
   no shutdown
      ip address 10.10.1.216/24 
exit
#! Static default route (Default Gateway) for OSPF underlay in default VRF
ip route 0.0.0.0/0 10.10.1.254

!# INTERFACE :: ETH 1/1 @ SPINE-1
interface ethernet1/1
   description ** OSPF Peer @ SPINE-1 **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.111/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!# INTERFACE :: ETH 1/2 @ SPINE-2
interface ethernet1/2
   description ** OSPF Peer @ SPINE-2 **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.119/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!#######################################################################################
!#  SAVE CHECKPOINT & CONFIGURATION                                                    #
!#######################################################################################

end
checkpoint fz3r0-2025-3tier-OSPF_base-NX9-LEAF-1B
copy running-config startup-config

!
!


````

## ü•á `NX9-LEAF-2A` - (LEAF 2 - VPC-A)

````py
configure terminal
banner motd $


#######################################################################################
#                                                                                     #
#                        - Fz3r0 :: Cisco Nexus Data Center -                         #
#                                                                                     #
#   * Github      : Fz3r0                                                             #
#   * Twitter     : @fz3r0_OPs                                                        #
#   * Youtube     : @fz3r0_OPs                                                        #
#                                                                                     #
# -._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-._.-=-._.-=-._.-=-.#
#                                                                                     #
#    NEXUS        : NX9-LEAF-2A                                                       #
#    ROLE         : LEAF                                                              #
#                                                                                     #
#    MGMT         : 10.10.66.17/24                                                    #
#    LOGIN        : admin / admin.cisco                                               #
#                                                                                     #
#    VRFs:                                                                            #
#    - default                                                                        #
#    - management                                                                     #
#    - *vpc-keepalive                                                                 #
#                                                                                     #
#    VPCs:                                                                            #
#    - vPC Domain 666 (LEAF-2A <==> LEAF-2B)                                          #
#      * PeerLink  @ Po100                                                            #
#      * KeepAlive @ Eth5                                                             #
#                                                                                     #
#    PORT CHANNELS:                                                                   #
#    - None                                                                           #
#                                                                                     #
#     OSPF UNDERLAY                                                                   #
#    - OSPF ID    : UNDERLAY-F0                                                       #
#    - OSPF AREA  : 0.0.0.0 (Backbone)                                                #
#    - Lo0        : 10.10.1.17/32                                                     #
#    - RID        : 10.10.1.17                                                        #
#    - Peer-SVI   : 10.10.1.217/24 (VLAN 10 - OSPF-PEER)                              #
#                                                                                     #
#######################################################################################


$

!# NAMINGS, USERS, LICENSES, DISCOVERY
hostname NX9-LEAF-2A
no password strength-check
username admin password admin.cisco role network-admin
cdp enable

!# MANAGEMENT INTERFACE & VRF (IP/GATEWAY)

!# Add DNS and Default Gateway to MGMT VLAN/VRF
vrf context management
   ip name-server 8.8.8.8 8.8.4.4
   ip route 0.0.0.0/0 10.10.66.254
!# Configure mgmt0 interface
interface mgmt0
   description ** MGMT INTERFACE **
   no shutdown
   vrf member management
   ip address 10.10.66.17/24
exit

!#######################################################################################
!#  FEATURES                                                                           #
!#######################################################################################

!# Port Channel & vPC: (tba)
feature vpc
feature lacp

!# Interface VLAN (for SVI)
feature interface-vlan

!# OSPF (Underlay)
feature ospf

!# Remote Connection
feature telnet
feature ssh

!# Discovery
feature lldp

!#######################################################################################
!#  vPC CONFIGURATION                                                                  #
!#######################################################################################

!# vPC Configuration: << vPC Domain 666 >> 

!# 1 - Create VRF "vpc-keepalive"
vrf context vpc-keepalive
   description ** Keepalive path for vPC control-plane **
exit

!# 2 - Create new "vpc-keepalive" physical interface for P2P link
interface Ethernet 1/5
   description ** vPC KeepAlive Link (A) **
   no shutdown
      no switchport
         vrf member vpc-keepalive
         ip address 10.10.255.1/30
exit

!# 3 - Create vPC Domain "666" and configure KeepAlive-Link (Primary = 100 (lower))
vpc domain 666
   peer-keepalive destination 10.10.255.2 source 10.10.255.1 vrf vpc-keepalive
      role priority 100              
      auto-recovery
      auto-recovery reload-delay 60
      delay restore 1             
      system-priority 1000             
exit

!# 4 - Configure vPC Peer Link - Port Channel 100 (Eth6 & Eth7)
interface ethernet 1/6
   description ** (Po100) vPC Peer-Link - Interface 1of2 **
   no shutdown
      channel-group 100 mode active
exit
interface ethernet 1/7
   description ** (Po100) vPC Peer-Link - Interface 2of2 **
   no shutdown
      channel-group 100 mode active
exit
interface port-channel 100
   description ** (Po100) vPC Peer-Link Port-Channel **
   no shutdown
      switchport
      switchport mode trunk
      switchport trunk allowed vlan 10
         vpc peer-link     
exit

!#######################################################################################
!#  OSPF (UNDERLAY)                                                                    #
!#######################################################################################

!# 1 - Activate OSPF Process
router ospf UNDERLAY-F0
   router-id 10.10.1.17
      log-adjacency-changes
exit

!# 2 - Configure Loopback 0 Interface
interface loopback 0
   description ** Loopback 0 - OSPF UNDERLAY **
      ip address 10.10.1.17/32
         ip router ospf UNDERLAY-F0 area 0.0.0.0
exit

!# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-#

!# 4 - OSPF Peer Interfaces @ OSPF Neighbors: 

#! SVI for VLAN 10 - OSPF Reachability
vlan 10
   name VLAN10-OSPF-PEER-GW
exit
interface vlan 10
   description ** SVI-V10-OSPF-UNDERLAY-GW **
   no shutdown
      ip address 10.10.1.217/24 
exit
#! Static default route (Default Gateway) for OSPF underlay in default VRF
ip route 0.0.0.0/0 10.10.1.254

!# INTERFACE :: ETH 1/1 @ SPINE-1
interface ethernet1/1
   description ** OSPF Peer @ SPINE-1 **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.113/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!# INTERFACE :: ETH 1/2 @ SPINE-2
interface ethernet1/2
   description ** OSPF Peer @ SPINE-2 **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.121/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!#######################################################################################
!#  SAVE CHECKPOINT & CONFIGURATION                                                    #
!#######################################################################################

end
checkpoint fz3r0-2025-3tier-OSPF_base-NX9-LEAF-2A
copy running-config startup-config

!
!


````

## ü•á `NX9-LEAF-2B` - (LEAF 2 - VPC-B)

````py
configure terminal
banner motd $


#######################################################################################
#                                                                                     #
#                        - Fz3r0 :: Cisco Nexus Data Center -                         #
#                                                                                     #
#   * Github      : Fz3r0                                                             #
#   * Twitter     : @fz3r0_OPs                                                        #
#   * Youtube     : @fz3r0_OPs                                                        #
#                                                                                     #
# -._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-._.-=-._.-=-._.-=-.#
#                                                                                     #
#    NEXUS        : NX9-LEAF-2B                                                       #
#    ROLE         : LEAF                                                              #
#                                                                                     #
#    MGMT         : 10.10.66.18/24                                                    #
#    LOGIN        : admin / admin.cisco                                               #
#                                                                                     #
#    VRFs:                                                                            #
#    - default                                                                        #
#    - management                                                                     #
#    - *vpc-keepalive                                                                 #
#                                                                                     #
#    VPCs:                                                                            #
#    - vPC Domain 666 (LEAF-2A <==> LEAF-2B)                                          #
#      * PeerLink  @ Po100                                                            #
#      * KeepAlive @ Eth5                                                             #
#                                                                                     #
#    PORT CHANNELS:                                                                   #
#    - None                                                                           #
#                                                                                     #
#     OSPF UNDERLAY                                                                   #
#    - OSPF ID    : UNDERLAY-F0                                                       #
#    - OSPF AREA  : 0.0.0.0 (Backbone)                                                #
#    - Lo0        : 10.10.1.18/32                                                     #
#    - RID        : 10.10.1.18                                                        #
#    - Peer-SVI   : 10.10.1.218/24 (VLAN 10 - OSPF-PEER)                              #
#                                                                                     #
#######################################################################################


$

!# NAMINGS, USERS, LICENSES, DISCOVERY
hostname NX9-LEAF-2B
no password strength-check
username admin password admin.cisco role network-admin
cdp enable

!# MANAGEMENT INTERFACE & VRF (IP/GATEWAY)

!# Add DNS and Default Gateway to MGMT VLAN/VRF
vrf context management
   ip name-server 8.8.8.8 8.8.4.4
   ip route 0.0.0.0/0 10.10.66.254
!# Configure mgmt0 interface
interface mgmt0
   description ** MGMT INTERFACE **
   no shutdown
   vrf member management
   ip address 10.10.66.18/24
exit

!#######################################################################################
!#  FEATURES                                                                           #
!#######################################################################################

!# Port Channel & vPC: (tba)
feature vpc
feature lacp

!# Interface VLAN (for SVI)
feature interface-vlan

!# OSPF (Underlay)
feature ospf

!# Remote Connection
feature telnet
feature ssh

!# Discovery
feature lldp

!#######################################################################################
!#  vPC CONFIGURATION                                                                  #
!#######################################################################################

!# vPC Configuration: << vPC Domain 666 >> 

!# 1 - Create VRF "vpc-keepalive"
vrf context vpc-keepalive
   description ** Keepalive path for vPC control-plane **
exit

!# 2 - Create new "vpc-keepalive" physical interface for P2P link
interface Ethernet 1/5
   description ** vPC KeepAlive Link (B) **
   no shutdown
      no switchport
         vrf member vpc-keepalive
         ip address 10.10.255.2/30
exit

!# 3 - Create vPC Domain "666" and configure KeepAlive-Link (Secondary = 200 (higher))
vpc domain 666
   peer-keepalive destination 10.10.255.1 source 10.10.255.2 vrf vpc-keepalive
      role priority 200              
      auto-recovery
      auto-recovery reload-delay 60
      delay restore 1             
      system-priority 1000             
exit

!# 4 - Configure vPC Peer Link - Port Channel 100 (Eth6 & Eth7)
interface ethernet 1/6
   description ** (Po100) vPC Peer-Link - Interface 1of2 **
   no shutdown
      channel-group 100 mode active
exit
interface ethernet 1/7
   description ** (Po100) vPC Peer-Link - Interface 2of2 **
   no shutdown
      channel-group 100 mode active
exit
interface port-channel 100
   description ** (Po100) vPC Peer-Link Port-Channel **
   no shutdown
      switchport
      switchport mode trunk
      switchport trunk allowed vlan 10
         vpc peer-link     
exit

!#######################################################################################
!#  OSPF (UNDERLAY)                                                                    #
!#######################################################################################

!# 1 - Activate OSPF Process
router ospf UNDERLAY-F0
   router-id 10.10.1.18
      log-adjacency-changes
exit

!# 2 - Configure Loopback 0 Interface
interface loopback 0
   description ** Loopback 0 - OSPF UNDERLAY **
      ip address 10.10.1.18/32
         ip router ospf UNDERLAY-F0 area 0.0.0.0
exit

!# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-#

!# 4 - OSPF Peer Interfaces @ OSPF Neighbors: 

#! SVI for VLAN 10 - OSPF Reachability
vlan 10
   name VLAN10-OSPF-PEER-GW
exit
interface vlan 10
   description ** SVI-V10-OSPF-UNDERLAY-GW **
   no shutdown
      ip address 10.10.1.218/24 
exit
#! Static default route (Default Gateway) for OSPF underlay in default VRF
ip route 0.0.0.0/0 10.10.1.254

!# INTERFACE :: ETH 1/1 @ SPINE-1
interface ethernet1/1
   description ** OSPF Peer @ SPINE-1 **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.115/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!# INTERFACE :: ETH 1/2 @ SPINE-2
interface ethernet1/2
   description ** OSPF Peer @ SPINE-2 **
   no shutdown
   speed 1000
   duplex full
      no switchport
      ip address 10.10.1.123/31
         ip router ospf UNDERLAY-F0 area 0.0.0.0
         ip ospf network point-to-point
         ip ospf cost 1
         ip ospf hello-interval 1
         ip ospf dead-interval 4
exit

!#######################################################################################
!#  SAVE CHECKPOINT & CONFIGURATION                                                    #
!#######################################################################################

end
checkpoint fz3r0-2025-3tier-OSPF_base-NX9-LEAF-2B
copy running-config startup-config

!
!


````





## üîÄ `IOS-SWITCH-MGMT` - (Switch Layer 2 - Management) 

````py
enable
configure terminal
banner motd $


#######################################################################################
#                                                                                     #
#                        - Fz3r0 :: Cisco Nexus Data Center -                         #
#                                                                                     #
#   * Github      : Fz3r0                                                             #
#   * Twitter     : @fz3r0_OPs                                                        #
#   * Youtube     : @fz3r0_OPs                                                        #
#                                                                                     #
# -._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-._.-=-._.-=-._.-=-.#
#                                                                                     #
#    NEXUS        : IOS-SWITCH-MGMT                                                   #
#    ROLE         : L3 SWITCH - MANAGEMENT SWITCH                                     #
#                                                                                     #
#    MGMT         : 10.10.66.250/24 (V66 NETWORK GATEWAY-1)                           #
#    LOGIN        : admin / admin.cisco                                               #
#                                                                                     #
#    TRUNK:                                                                           #
#                                                                                     #
#    ACCESS:                                                                           #
#    - none                                                                           #
#                                                                                     #
#    PORT CHANNELS:                                                                   #
#    - None                                                                           #
#                                                                                     #
#######################################################################################


$

!# NAMINGS, USERS, LICENSES, DISCOVERY
hostname IOS-SWITCH-MGMT 
username admin password admin.cisco role network-admin

!#######################################################################################
!#  VLANS                                                                              #
!#######################################################################################

vlan 66
   name V66-MGMT-VRFmgmt
exit

!#######################################################################################
!#  MANAGEMENT SVI & INTERFACE                                                         #
!#######################################################################################

!# INTERFACE :: SVI @ MGMT

interface vlan 66
   description ** SVI-V66-MGMT **
   no shutdown
      ip address 10.10.66.250 255.255.255.0 
exit
#! Default Gateway for mgmt @ MGMT switch
ip default-gateway 10.10.66.254

!#######################################################################################
!#  ALL INTERFACES = ACCESS VLAN 66 MANAGEMENT                                         #
!#######################################################################################

!# INTERFACE :: ALL @ SWITCH-L2 & LAN (Access) :: VRF management
interface range ethernet0/0-3,ethernet1/0-3,ethernet2/1-3
   description ** Access MGMT @ Network Devices - VRF: management **
   no shutdown
   duplex full
      switchport
      switchport mode access
      switchport access vlan 66
exit

!#######################################################################################
!#  TRUNK INTERFACES (VRF: management) ==>> @ ROUTER-WAN                               #
!#######################################################################################

!# INTERFACE :: Eth 2/0 @ ROUTER-WAN 
interface ethernet 2/0
   description ** Trunk @ ROUTER-WAN **
   no shutdown
   duplex full
      switchport
      switchport trunk encapsulation dot1q
      switchport mode trunk
      switchport trunk allowed vlan 66
exit

!#######################################################################################
!#  SAVE CONFIGURATION                                                                 #
!#######################################################################################

end
write memory


!
!

````







## üîÄ `IOS-RT-WAN` - (Router WAN - top) 

````py
enable
configure terminal
banner motd $


#######################################################################################
#                                                                                     #
#                        - Fz3r0 :: Cisco Nexus Data Center -                         #
#                                                                                     #
#   * Github      : Fz3r0                                                             #
#   * Twitter     : @fz3r0_OPs                                                        #
#   * Youtube     : @fz3r0_OPs                                                        #
#                                                                                     #
# -._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-._.-=-._.-=-._.-=-.#
#                                                                                     #
#    NEXUS        : IOS-RT-WAN                                                        #
#    ROLE         : WAN ROUTER / NAT GATEWAY                                          #
#                                                                                     #
#    MGMT         : 10.10.66.254/24 (V66 NETWORK GATEWAY-1)                           #
#    LOGIN        : admin / admin.cisco                                               #
#                                                                                     #
#    TRUNK:                                                                           #
#                                                                                     #
#    ACCESS:                                                                          #
#    - none                                                                           #
#                                                                                     #
#    PORT CHANNELS:                                                                   #
#    - None                                                                           #
#                                                                                     #
#######################################################################################


$

!# NAMINGS, USERS, LICENSES, DISCOVERY
hostname IOS-RT-WAN

!#######################################################################################
!#  ENABLE IP ROUTING                                                                  #
!#######################################################################################

!# Enables the router to forward packets BETWEEN DIFFERENT NETWORKS (turns on Layer 3 routing between management & default VRFs)
ip routing

!#######################################################################################
!#  L3 INTERFACE & SUB-INTERFACE @ LAN - VRF: management / VLAN 66                     #
!#######################################################################################

#! L3 PHYSICAL INTERFACE @ GATEWAY FOR LAN - VRF: management / VLAN 66
#! Gateway Sub-Interfaces @ LAN
interface Ethernet 0/0
   description ** Physical Link to -> IOS-SW-WAN **
   no shutdown
   duplex full
exit
#! L3 SUB-INTERFACE @ GATEWAY FOR LAN - VRF: management / VLAN 66
interface Ethernet 0/0.66
   description ** V66 Sub-Interface for -> IOS-SW-WAN **
   no shutdown
      encapsulation dot1Q 66
      ip address 10.10.66.254 255.255.255.0
         ip nat inside
exit

!#######################################################################################
!#  OSPF Peer-Links to BGW1 & BGW2                                                     #
!#######################################################################################

router ospf 10 
   router-id 10.10.1.254
      !# OSPF Peers
      network 10.10.2.100 0.0.0.1 area 0
      network 10.10.2.104 0.0.0.1 area 0
      !# mgmt network rotuing trick!
      network 10.10.66.0 0.0.0.255 area 0    
exit

interface Loopback 0
   description ** Loopback for OSPF 10 **
   no shutdown 
      ip address 10.10.1.254 255.255.255.255
exit

!#  L3 INTERFACE & SUB-INTERFACE @ LAN - VRF: default / VLAN 10 (BGW1 link)    

#! L3 PHYSICAL INTERFACE @ OSPF PEER-LINK @ BGW-1
interface Ethernet0/1
   description ** Physical Link to -> BGW-1 **
   no shutdown
   duplex full
exit
#! L3 SUB-INTERFACE @ GATEWAY FOR LAN - VRF: management / VLAN 66
interface Ethernet0/1.10
   description ** V10 Sub-Interface for -> BGW-1 **
   no shutdown
      encapsulation dot1Q 10
      ip address 10.10.2.101 255.255.255.252
         ip nat inside
            ip ospf network point-to-point
            ip ospf cost 1
            ip ospf hello-interval 1
            ip ospf dead-interval 4
exit

!#  L3 INTERFACE & SUB-INTERFACE @ LAN - VRF: default / VLAN 10 (BGW2 link)          

#! L3 PHYSICAL INTERFACE @ OSPF PEER-LINK @ BGW-2
interface Ethernet0/3
   description ** Physical Link to -> BGW-2 **
   no shutdown
   duplex full
exit
#! L3 SUB-INTERFACE @ GATEWAY FOR LAN - VRF: management / VLAN 66
interface Ethernet0/3.10
   description ** V10 Sub-Interface for -> BGW-2 **
   no shutdown
      encapsulation dot1Q 10
      ip address 10.10.2.105 255.255.255.252
         ip nat inside
            ip ospf network point-to-point
            ip ospf cost 1
            ip ospf hello-interval 1
            ip ospf dead-interval 4
exit

!#######################################################################################
!#  L3 INTERFACE @ WAN + NAT TRANSLATION / INTERNET // OUTSIDE                         #
!#######################################################################################

!# WAN INTERFACE (NAT OUTSIDE) [Default Route @ Internet]
interface Ethernet 0/2
   description ** Link-to-WAN-1_INTERNET **
   no shutdown
   duplex full
      ip address 123.1.1.2 255.255.255.252
         ip nat outside
exit
!# Ruta por defecto hacia la nube Google
ip route 0.0.0.0 0.0.0.0 123.1.1.1

!#######################################################################################
!#  NAT TRANSLATION CONFIGURATION, INSIDE-OUTSIDE                                      #
!#######################################################################################

!# ACL que define el trafico interno a traducir
access-list 10 permit 10.10.0.0 0.0.255.255

!# Overload all matching inside traffic to the WAN interface address
ip nat inside source list 10 interface Ethernet 0/2 overload

!#######################################################################################
!#  SAVE CONFIGURATION                                                                 #
!#######################################################################################

end
write memory

!
!


````

## üîÄ `vEDGE-2` - (Router 2 - SDWAN Edge) 

````py


````










!# INTERFACE :: ETH 1/3 @ SWITCH-L2 (Trunk)
interface ethernet1/3
   description ** WAN Interface Trunk @ SWITCH-L2 **
   no shutdown
   speed 10000
   duplex full
      switchport
      switchport trunk encapsulation dot1q
      switchport mode trunk
      switchport trunk allowed vlan 10
exit




interface Ethernet1/34
  description Link to TK2-WAN-R1 Fo0/2/8
  speed 40000
  no negotiate auto
  no shutdown

interface Ethernet1/34.48
  description Link to TK2-WAN-R1 Fo0/2/8.48
  encapsulation dot1q 48
  vrf member internal01
  ip address 10.64.255.48/31 tag 12345
  no shutdown






# üóÉÔ∏è Resources

- https://www.youtube.com/watch?v=fWCH39T-_fU

---

<span align="center"> <p align="center"> ![giphy](https://user-images.githubusercontent.com/94720207/166587250-292d9a9f-e590-4c25-a678-d457e2268e85.gif) </p> </span> 

&nbsp;

<span align="center"> <p align="center"> _I hope this information was useful for someone_ </p> </span> 
<span align="center"> <p align="center"> _and please, don't forget to enjoy your days..._ </p> </span> 
<span align="center"> <p align="center"> _...It is getting dark... so dark..._ </p> </span> 

&nbsp;

<span align="center"> <p align="center"> _In the mist of the night you could see me come, where shadows move and Demons lie..._ </p> </span> 
<span align="center"> <p align="center"> _I am [Fz3r0 üíÄ](https://github.com/Fz3r0/) and the Sun no longer rises..._ </p> </span> 

---

---

> ![hecho en mexico 5](https://user-images.githubusercontent.com/94720207/166068790-fa1f243d-2db9-4810-a6e4-eb3c4ad23700.png)
>
> _- Hecho en M√©xico - by [Fz3r0 üíÄ](https://github.com/Fz3r0/)_  
>
> _"In the mist of the night you could see me come, where shadows move and Demons lie..."_ 
